{"version":3,"file":"cot-terms-view.min.js","sources":["cot-terms-view.min.js"],"sourcesContent":["\"use strict\";\n\n/* global $ _ */\n\n/* global View */\nvar CotTermsView = View.extend({\n\ttermsText: null,\n\tdisagreedText: null,\n\tagreedCookieName: function agreedCookieName() {\n\t\treturn _.result(this.constructor, 'agreedCookieName');\n\t},\n\tagreementTitle: null,\n\tagreeText: null,\n\tagreeButton: null,\n\trender: function render() {\n\t\tvar _this = this;\n\n\t\tvar _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n\t\t\t_ref$setFocus = _ref.setFocus,\n\t\t\tsetFocus = _ref$setFocus === void 0 ? false : _ref$setFocus;\n\n\t\tthis.$el.empty();\n\t\tvar options = {\n\t\t\tcontainerSelector: this.$el,\n\t\t\tonAgreed: function onAgreed() {\n\t\t\t\t_this.trigger('agreed');\n\t\t\t}\n\t\t};\n\n\t\tvar termsText = _.result(this, 'termsText');\n\n\t\tif (termsText) {\n\t\t\toptions.termsText = termsText;\n\t\t}\n\n\t\tvar disagreedText = _.result(this, 'disagreedText');\n\n\t\tif (disagreedText) {\n\t\t\toptions.disagreedText = disagreedText;\n\t\t}\n\n\t\tvar agreedCookieName = _.result(this, 'agreedCookieName');\n\n\t\tif (agreedCookieName) {\n\t\t\toptions.agreedCookieName = agreedCookieName;\n\t\t}\n\n\t\tvar agreementTitle = _.result(this, 'agreementTitle');\n\n\t\tif (agreementTitle) {\n\t\t\toptions.agreementTitle = agreementTitle;\n\t\t}\n\n\t\tvar agreeText = _.result(this, 'agreeText');\n\n\t\tif (agreeText) {\n\t\t\toptions.agreeText = agreeText;\n\t\t}\n\n\t\tvar agreeButton = _.result(this, 'agreeButton');\n\n\t\tif (agreeButton) {\n\t\t\toptions.agreeButton = agreeButton;\n\t\t}\n\n\t\tvar cotApp = window['cot_app'] || window['CotApp'];\n\t\tcotApp.showTerms(options);\n\t\tvar $termsAgree = $('#termsAgree'); // Dont know why, but this doesn't work unless it's inside a set timeout.\n\n\t\tvar onError = function onError() {\n\t\t\treturn void setTimeout(function() {\n\t\t\t\treturn void $termsAgree.focus();\n\t\t\t}, 0);\n\t\t};\n\n\t\t$termsAgree.on('click', function() {\n\t\t\tif (!$termsAgree.is(':checked')) {\n\t\t\t\tonError();\n\t\t\t}\n\t\t});\n\t\tvar $cotTermsAgree = $(\"#cot-terms-agree\");\n\t\t$cotTermsAgree.on('click', function() {\n\t\t\tif (!$termsAgree.is(':checked')) {\n\t\t\t\tonError();\n\t\t\t}\n\t\t});\n\t\tvar $title = $('h2', this.$el).attr('tabindex', '-1').first();\n\n\t\tif (setFocus) {\n\t\t\t$title.focus();\n\t\t}\n\n\t\treturn View.prototype.render.call(this, {\n\t\t\tsetFocus: setFocus\n\t\t});\n\t}\n}, {\n\tagreedCookieName: 'terms',\n\tisNeeded: function isNeeded() {\n\t\tvar agreedCookieName = _.result(this, 'agreedCookieName');\n\n\t\tvar regExp = new RegExp('(?:(?:^|.*;\\\\s*)'.concat(encodeURI(agreedCookieName), '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'));\n\t\treturn document.cookie.replace(regExp, '$1') !== 'agree';\n\t}\n});\n/* exported CotTermsView */\n"],"names":["CotTermsView","View","extend","termsText","disagreedText","agreedCookieName","_","result","this","constructor","agreementTitle","agreeText","agreeButton","render","_this","_ref$setFocus","arguments","length","undefined","setFocus","options","$el","empty","containerSelector","onAgreed","trigger","onError","setTimeout","$termsAgree","focus","window","showTerms","$","on","is","$title","attr","first","prototype","call","isNeeded","regExp","RegExp","concat","encodeURI","document","cookie","replace"],"mappings":"aAKA,IAAIA,aAAeC,KAAKC,OAAO,CAC9BC,UAAW,KACXC,cAAe,KACfC,iBAAkB,WACjB,OAAOC,EAAEC,OAAOC,KAAKC,YAAa,qBAEnCC,eAAgB,KAChBC,UAAW,KACXC,YAAa,KACbC,OAAQ,WACP,IAAIC,EAAQN,KAGXO,GAD6B,EAAnBC,UAAUC,aAA+BC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,IACzDG,SACrBA,OAA6B,IAAlBJ,GAAmCA,EAG3CK,GADJZ,KAAKa,IAAIC,QACK,CACbC,kBAAmBf,KAAKa,IACxBG,SAAU,WACTV,EAAMW,QAAQ,aAIZtB,EAAYG,EAAEC,OAAOC,KAAM,aAM3BJ,GAJAD,IACHiB,EAAQjB,UAAYA,GAGDG,EAAEC,OAAOC,KAAM,kBAM/BH,GAJAD,IACHgB,EAAQhB,cAAgBA,GAGFE,EAAEC,OAAOC,KAAM,qBAMlCE,GAJAL,IACHe,EAAQf,iBAAmBA,GAGPC,EAAEC,OAAOC,KAAM,mBAMhCG,GAJAD,IACHU,EAAQV,eAAiBA,GAGVJ,EAAEC,OAAOC,KAAM,cAM3BI,GAJAD,IACHS,EAAQT,UAAYA,GAGHL,EAAEC,OAAOC,KAAM,gBAE7BI,IACHQ,EAAQR,YAAcA,GAOT,SAAVc,IACSC,WAAW,WACVC,EAAYC,SACtB,IAPSC,OAAgB,SAAKA,OAAe,QAC1CC,UAAUX,GAnDjB,IAoDIQ,EAAcI,EAAE,eAQpBJ,EAAYK,GAAG,QAAS,WAClBL,EAAYM,GAAG,aACnBR,MAGmBM,EAAE,oBACRC,GAAG,QAAS,WACrBL,EAAYM,GAAG,aACnBR,MAGES,EAASH,EAAE,KAAMxB,KAAKa,KAAKe,KAAK,WAAY,MAAMC,QAMtD,OAJIlB,GACHgB,EAAON,QAGD5B,KAAKqC,UAAUzB,OAAO0B,KAAK/B,KAAM,CACvCW,SAAUA,MAGV,CACFd,iBAAkB,QAClBmC,SAAU,WACT,IAAInC,EAAmBC,EAAEC,OAAOC,KAAM,oBAElCiC,EAAS,IAAIC,OAAO,mBAAmBC,OAAOC,UAAUvC,GAAmB,gCAC/E,MAAiD,UAA1CwC,SAASC,OAAOC,QAAQN,EAAQ"}