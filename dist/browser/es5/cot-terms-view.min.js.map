{"version":3,"file":"cot-terms-view.min.js","sources":["cot-terms-view.min.js"],"sourcesContent":["\"use strict\";\n\n/* global $ _ */\n\n/* global View */\nvar CotTermsView = View.extend({\n  termsText: null,\n  disagreedText: null,\n  agreedCookieName: function agreedCookieName() {\n    return _.result(this.constructor, 'agreedCookieName');\n  },\n  agreementTitle: null,\n  agreeText: null,\n  agreeButton: null,\n  render: function render() {\n    var _this = this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$setFocus = _ref.setFocus,\n        setFocus = _ref$setFocus === void 0 ? false : _ref$setFocus;\n\n    this.$el.empty();\n    var options = {\n      containerSelector: this.$el,\n      onAgreed: function onAgreed() {\n        _this.trigger('agreed');\n      }\n    };\n\n    var termsText = _.result(this, 'termsText');\n\n    if (termsText) {\n      options.termsText = termsText;\n    }\n\n    var disagreedText = _.result(this, 'disagreedText');\n\n    if (disagreedText) {\n      options.disagreedText = disagreedText;\n    }\n\n    var agreedCookieName = _.result(this, 'agreedCookieName');\n\n    if (agreedCookieName) {\n      options.agreedCookieName = agreedCookieName;\n    }\n\n    var agreementTitle = _.result(this, 'agreementTitle');\n\n    if (agreementTitle) {\n      options.agreementTitle = agreementTitle;\n    }\n\n    var agreeText = _.result(this, 'agreeText');\n\n    if (agreeText) {\n      options.agreeText = agreeText;\n    }\n\n    var agreeButton = _.result(this, 'agreeButton');\n\n    if (agreeButton) {\n      options.agreeButton = agreeButton;\n    }\n\n    var cotApp = window['cot_app'] || window['CotApp'];\n    cotApp.showTerms(options);\n    var $termsAgree = $('#termsAgree'); // Dont know why, but this doesn't work unless it's inside a set timeout.\n\n    var onError = function onError() {\n      return void setTimeout(function () {\n        return void $termsAgree.focus();\n      }, 0);\n    };\n\n    $termsAgree.on('click', function () {\n      if (!$termsAgree.is(':checked')) {\n        onError();\n      }\n    });\n    var $cotTermsAgree = $(\"#cot-terms-agree\");\n    $cotTermsAgree.on('click', function () {\n      if (!$termsAgree.is(':checked')) {\n        onError();\n      }\n    });\n    var $title = $('h2', this.$el).attr('tabindex', '-1').first();\n\n    if (setFocus) {\n      $title.focus();\n    }\n\n    return View.prototype.render.call(this, {\n      setFocus: setFocus\n    });\n  }\n}, {\n  agreedCookieName: 'terms',\n  isNeeded: function isNeeded() {\n    var agreedCookieName = _.result(this, 'agreedCookieName');\n\n    var regExp = new RegExp('(?:(?:^|.*;\\\\s*)'.concat(encodeURI(agreedCookieName), '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'));\n    return document.cookie.replace(regExp, '$1') !== 'agree';\n  }\n});\n/* exported CotTermsView */"],"names":["CotTermsView","View","extend","termsText","disagreedText","agreedCookieName","_","result","this","constructor","agreementTitle","agreeText","agreeButton","render","_this","_ref$setFocus","arguments","length","undefined","setFocus","options","$el","empty","containerSelector","onAgreed","trigger","onError","setTimeout","$termsAgree","focus","window","showTerms","$","on","is","$title","attr","first","prototype","call","isNeeded","regExp","RegExp","concat","encodeURI","document","cookie","replace"],"mappings":"aAKA,IAAIA,aAAeC,KAAKC,OAAO,CAC7BC,UAAW,KACXC,cAAe,KACfC,iBAAkB,WAChB,OAAOC,EAAEC,OAAOC,KAAKC,YAAa,qBAEpCC,eAAgB,KAChBC,UAAW,KACXC,YAAa,KACbC,OAAQ,WACN,IAAIC,EAAQN,KAGRO,GAD0B,EAAnBC,UAAUC,aAA+BC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,IACtDG,SACrBA,OAA6B,IAAlBJ,GAAmCA,EAG9CK,GADJZ,KAAKa,IAAIC,QACK,CACZC,kBAAmBf,KAAKa,IACxBG,SAAU,WACRV,EAAMW,QAAQ,aAIdtB,EAAYG,EAAEC,OAAOC,KAAM,aAM3BJ,GAJAD,IACFiB,EAAQjB,UAAYA,GAGFG,EAAEC,OAAOC,KAAM,kBAM/BH,GAJAD,IACFgB,EAAQhB,cAAgBA,GAGHE,EAAEC,OAAOC,KAAM,qBAMlCE,GAJAL,IACFe,EAAQf,iBAAmBA,GAGRC,EAAEC,OAAOC,KAAM,mBAMhCG,GAJAD,IACFU,EAAQV,eAAiBA,GAGXJ,EAAEC,OAAOC,KAAM,cAM3BI,GAJAD,IACFS,EAAQT,UAAYA,GAGJL,EAAEC,OAAOC,KAAM,gBAE7BI,IACFQ,EAAQR,YAAcA,GAOV,SAAVc,IACUC,WAAW,WACTC,EAAYC,SACvB,IAPQC,OAAgB,SAAKA,OAAe,QAC1CC,UAAUX,GAnDjB,IAoDIQ,EAAcI,EAAE,eAQpBJ,EAAYK,GAAG,QAAS,WACjBL,EAAYM,GAAG,aAClBR,MAGiBM,EAAE,oBACRC,GAAG,QAAS,WACpBL,EAAYM,GAAG,aAClBR,MAGAS,EAASH,EAAE,KAAMxB,KAAKa,KAAKe,KAAK,WAAY,MAAMC,QAMtD,OAJIlB,GACFgB,EAAON,QAGF5B,KAAKqC,UAAUzB,OAAO0B,KAAK/B,KAAM,CACtCW,SAAUA,MAGb,CACDd,iBAAkB,QAClBmC,SAAU,WACR,IAAInC,EAAmBC,EAAEC,OAAOC,KAAM,oBAElCiC,EAAS,IAAIC,OAAO,mBAAmBC,OAAOC,UAAUvC,GAAmB,gCAC/E,MAAiD,UAA1CwC,SAASC,OAAOC,QAAQN,EAAQ"}